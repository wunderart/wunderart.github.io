function Crossvp(){this.win="undefined"!=typeof window&&window,this.doc="undefined"!=typeof document&&document,this.docElem=this.doc&&this.doc.documentElement,this.matchMedia=this.win.matchMedia||this.win.msMatchMedia,this.viewportW=function(){var e=this.docElem.clientWidth,t=this.win.innerWidth;return t>e?t:e},this.viewportH=function(){var e=this.docElem.clientHeight,t=this.win.innerHeight;return t>e?t:e},this.scrollY=function(){return this.win.pageYOffset||this.docElem.scrollTop},this.getDocHeight=function(){return Math.max(this.doc.body.scrollHeight,this.docElem.scrollHeight,this.doc.body.offsetHeight,this.docElem.offsetHeight,this.doc.body.clientHeight,this.docElem.clientHeight)}}function ImageLazyLoader(e,t,i,s,o){this.images=e,this.imageElements=[],this.nextToLoad=0,this.initialBatch=s||6,this.lazyBatch=o||3,this.myGrid=document.getElementById(t),this.gridClass=t,this.gridSizerClass=i,this.masonry=void 0,this.fadeInAll=function(){for(var e=document.getElementsByClassName(this.gridSizerClass),t=0;t<e.length;t++)e[t].style.opacity=1;crossvp.getDocHeight()<=crossvp.viewportH()&&this.nextToLoad<this.images.length&&this.addImages(),this.nextToLoad<this.images.length&&void 0!==document.getElementsByClassName("scroll-hint")[0]&&(document.getElementsByClassName("scroll-hint")[0].style.visibility="visible")},this.marginBottomLoadTrigger=700,this.loadInProgress=!1,this.pendingload=0,this.loadedCallback=void 0}var crossvp=new Crossvp;ImageLazyLoader.prototype.loadNextImages=function(e){var t=this,i=e?this.initialBatch:this.lazyBatch;this.imageElements=[],this.pendingload=Math.max(0,Math.min(this.nextToLoad+i,this.images.length)-this.nextToLoad);for(var s=this.nextToLoad;s<Math.min(this.nextToLoad+i,this.images.length);s++){var o=document.createElement("div");o.className=this.gridSizerClass;var a=document.createElement("img");a.onload=function(){t.pendingload--,0===t.pendingload&&t.loadedCallback&&t.loadedCallback()},a.setAttribute("src",this.images[s].image);var n=document.createTextNode(this.images[s].caption),d=document.createElement("p");if(d.appendChild(n),a.setAttribute("src",this.images[s].image),this.images[s].ref){var l=document.createElement("a");l.setAttribute("href",this.images[s].ref),l.appendChild(a),l.appendChild(d),o.appendChild(l)}else o.appendChild(a),o.appendChild(d);this.imageElements.push(o)}this.nextToLoad=Math.min(s,this.images.length),this.nextToLoad>=this.images.length&&(window.onscroll=function(){crossvp.viewportH()+crossvp.scrollY()>=crossvp.getDocHeight()-10&&t.nextToLoad>=t.images.length&&(void 0!==document.getElementsByClassName("scroll-hint")[0]&&(document.getElementsByClassName("scroll-hint")[0].style.visibility="hidden"),window.onscroll=void 0)})},ImageLazyLoader.prototype.appendImagesToMasonryGrid=function(){var e=this;return this.pendingload>0?void(this.loadedCallback=function(){e.appendImagesToMasonryGrid()}):(this.loadedCallback=void 0,this.imageElements.forEach(function(t){e.myGrid.appendChild(t)}),void(this.masonry?(e.masonry.appended(e.imageElements),document.getElementsByClassName("grid-item-loader")[0].style.visibility="hidden",e.loadInProgress=!1,e.fadeInAll()):(e.masonry=new Masonry("."+e.gridClass,{itemSelector:"."+e.gridSizerClass,transitionDuration:0,percentPosition:!0}),e.fadeInAll(),window.onscroll=function(){!e.loadInProgress&&crossvp.viewportH()+crossvp.scrollY()>=crossvp.getDocHeight()-e.marginBottomLoadTrigger&&e.addImages()})))},ImageLazyLoader.prototype.addImages=function(){document.getElementsByClassName("grid-item-loader")[0].style.visibility="visible",this.loadInProgress=!0,this.loadNextImages(!1),this.appendImagesToMasonryGrid()};